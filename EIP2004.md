---
eip: 2004
title: Agent-Readable Smart Contract Documentation Layer (Intent Spec)
description: A standard for machine-verifiable semantic metadata to enable autonomous agent reasoning
author: Collins Adi (@collinsadi)
status: Draft
type: Standards Track
category: ERC
created: 2026-02-11
requires: 165
---

## Abstract

This proposal defines a standard for attaching machine-readable semantic manifests to Ethereum smart contracts. It defines a machine-readable schema for documenting the **semantic intent**, **preconditions**, and **economic risks** of smart contract functions. By extending Ethereum's NatSpec, it allows developers to provide a "Reasoning Layer" for Autonomous AI Agents, preventing "blind signing" and enabling proactive safety verification.

While the Application Binary Interface (ABI) provides the technical interface for function execution, it lacks the context required for autonomous AI agents to understand economic intent, safety boundaries, and irreversible effects. This EIP introduces the **Intent Spec** layer: an on-chain metadata pointer via the `IIntentSpec` interface and a standardized JSON schema for the manifest. This allows agents to move from probabilistic inference to deterministic intent verification.

## Motivation

Smart contracts today are primarily designed for human auditors. AI agents navigating an increasingly autonomous on-chain ecosystem must infer function purpose from brittle sources such as naming conventions or sparse NatSpec comments. As agents begin managing meaningful capital, ambiguity becomes a systemic risk.

Current ABIs provide the technical signature of a function but zero context regarding its intent. As AI agents become primary on-chain actors, they require a standardized handshake to understand: **Intent** (what is the actual goal of this call?), **Preconditions** (what state must exist for this to be safe?), and **Risks** (what are the potential negative outcomes, e.g. slippage, liquidity lock?).

ERC-8004 standardizes on-chain infrastructure for autonomous agents, including identity, reputation, and validation registries. However, it does not define how agents interpret the semantic meaning of arbitrary smart contract functions. **ERC-2004** complements ERC-8004 by providing a structured semantic documentation layer at the contract level, enabling agents to reason about economic intent and safety constraints before execution.

An agent may technically execute a function correctly while misunderstanding:

- **Economic intent** — mistaking a wrap for a swap  
- **Permission boundaries** — unintentionally delegating authority  
- **Irreversible effects** — permanently destroying assets  

This proposal introduces a structured documentation layer optimized for machine reasoning, reducing the probability of agentic failure and improving deterministic verification.

## Specification

The key words **MUST**, **MUST NOT**, **REQUIRED**, **SHALL**, **SHALL NOT**, **SHOULD**, **SHOULD NOT**, **RECOMMENDED**, **MAY**, and **OPTIONAL** in this document are to be interpreted as described in RFC 2119.

### Interface Detection

Smart contracts implementing this standard **MUST** support ERC-165 interface detection.

### `IIntentSpec` Interface

Contracts **MUST** expose a metadata pointer through the following interface:

```solidity
pragma solidity ^0.8.0;

/// @title IIntentSpec
/// @notice Interface for contracts that expose their Intent Spec metadata URI (e.g. IPFS hash).
interface IIntentSpec {
    /// @notice Returns the URI where the Intent Spec JSON for this contract is stored.
    /// @return The URI (e.g. ipfs://Qm... or https://...) pointing to the intentspec.json.
    function getIntentSpecURI() external view returns (string memory);
}
````

### Manifest Schema

The resource returned by `getIntentSpecURI()` **MUST** resolve to a JSON object conforming to the Intent Spec schema. The canonical schema is defined at `https://intentspec.collinsadi.xyz/v1/intentspec.schema.json`. The structure is:

```json
{
  "contract": {
    "name": "string",
    "version": "string",
    "description": "string"
  },
  "functions": [
    {
      "name": "string",
      "intent": "string",
      "signature": "string",
      "preconditions": ["string"],
      "effects": ["string"],
      "risks": ["string"],
      "agentGuidance": "string"
    }
  ],
  "events": [
    {
      "name": "string",
      "description": "string"
    }
  ],
  "invariants": ["string"]
}
```

#### Schema Requirements

* `contract` and `functions` are **REQUIRED**. `events` and `invariants` are OPTIONAL.
* Each function entry **MUST** include `name` and `intent`. `signature` is the EVM function selector (first 4 bytes of `keccak256(functionSignature)`) in hexadecimal (e.g. `0x12345678`).
* Agents MAY ignore unknown fields to preserve forward compatibility.

### Metadata Resolution

The metadata URI SHOULD reference immutable content, such as IPFS or a content-addressed storage system. The manifest MUST remain stable once deployed.

### Developer Workflow (Non-Normative)

Developers MAY generate manifests from Solidity using custom NatSpec tags. Only functions annotated with `@custom:agent-intent` are included. Supported tags include:

| Level    | Tag                          | Purpose                       |
| -------- | ---------------------------- | ----------------------------- |
| Contract | `@custom:agent-version`      | Contract version              |
| Contract | `@custom:agent-description`  | Short description             |
| Contract | `@custom:agent-invariant`    | Invariant (repeatable)        |
| Contract | `@custom:agent-event`        | Event name + description      |
| Function | `@custom:agent-intent`       | **Required.** One-line intent |
| Function | `@custom:agent-precondition` | Precondition (repeatable)     |
| Function | `@custom:agent-effect`       | Effect (repeatable)           |
| Function | `@custom:agent-risk`         | Risk (repeatable)             |
| Function | `@custom:agent-guidance`     | Guidance for agents           |

Tooling (e.g. the Intent Spec CLI) MAY extract these tags at build time and emit schema-conformant JSON to `intentspec/<ContractName>.json`.

## Rationale

### Structured JSON Schema

A standardized schema ensures agents can parse manifests without ambiguity. Required fields (`contract`, `functions`, and per-function `name` and `intent`) provide a minimal guarantee for machine reasoning while optional fields support richer semantics.

### Off-Chain Metadata

Storing semantic metadata entirely on-chain is cost prohibitive. A URI pointer preserves immutability while minimizing gas overhead. Using IPFS (or similar content-addressed storage) for the manifest ensures that the intent documentation can be as immutable as the contract itself.

### Single Discovery Entry Point

`getIntentSpecURI()` gives agents one on-chain call to discover the full semantic manifest, enabling a consistent verification loop: discover metadata, validate declared intent against the goal, and simulate to confirm state changes align with declared effects.

## Backwards Compatibility

This proposal is fully backwards compatible.

Existing contracts MAY support the interface through:

* Proxy upgrades
* Peripheral metadata registries
* Wrapper contracts

Agents SHOULD treat unsupported contracts as lacking semantic metadata.

## Test Cases

Reference implementations, tooling, and demonstrations MAY include:

* Example contracts implementing `IIntentSpec`
* Manifest validation tooling (e.g. against the canonical JSON schema)
* Agent-side verification workflows

These are non-normative and serve as developer guidance.

## Security Considerations

### Misrepresentation Risk

Developers could provide inaccurate or malicious metadata. Agents SHOULD verify authenticity through deployer signatures or trusted auditor attestations.

### Simulation Verification

Agents SHOULD simulate execution and compare observed state transitions with the manifest’s declared **effects**. If inconsistencies are detected, execution SHOULD be aborted.

### Metadata Integrity

Agents MUST verify content-addressed URIs to prevent tampering or substitution attacks.

## Copyright

Copyright and related rights waived via CC0.

